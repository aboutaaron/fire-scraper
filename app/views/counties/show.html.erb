<div class="row">
    <div id="scrollSpy" class="span4" data-spy="#affix" data-offset-top="20">
        <div class="page-header">
          <h1><%= @county.name %> County</h1>
        </div>
        <p id="notice"><%= notice %></p>
        <script type="text/javascript">
          jQuery(document).ready(function($) {

            // Map Setup
            //var layer = new L.StamenTileLayer("terrain")
            var map = new L.map('map', {
              center: new L.LatLng(<%= @county.latitude %>, <%= @county.longitude %>),
              zoom: 7,
              scrollWheelZoom: false,
              touchZoom: false,
              doubleClickZoom: false,
              zoomControl: false,
              dragging: false
            });
            //map.addLayer(layer)

            L.tileLayer('http://{s}.tile.cloudmade.com/0064577453aa486d98cec7f0ef57578f/997/256/{z}/{x}/{y}.png', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
                maxZoom: 18
            }).addTo(map);

            //Adding Stamen attribution
            poweredByStamen = new L.Control.Attribution
            poweredByStamen.addAttribution("Map tiles by <a href='http://stamen.com'>Stamen Design</a>, under <a href='http://creativecommons.org/licenses/by/3.0'>CC BY 3.0</a>. Data by <a href='http://openstreetmap.org'>OpenStreetMap</a>, under <a href='http://creativecommons.org/licenses/by-sa/3.0'>CC BY SA</a>.")
            //map.addControl(poweredByStamen)

            // Hack until i fix Leaflet attribution
            //$(".leaflet-control-attribution.leaflet-control")[1].remove();


            // GeoJSON
            // http://stackoverflow.com/a/8585115/868724
            var i = boundaries.features.length;
            while( i-- ) {
                if( boundaries.features[i].properties.NAME === '<%= @county.name %>' ) break;
            }
            L.geoJson(boundaries.features[i], {style:style}).addTo(map);
            console.log(boundaries.features[i].properties.NAME)// will be -1 if no match was found

            function style(feature) {
                return {
                    fillColor: '#9d261d',
                    weight: 2,
                    opacity: 1,
                    color: 'white',
                    dashArray: '3',
                    fillOpacity: 0.4
                };
            }
          });
        </script>
        <div id="map"></div>
        <h4>More information:</h4>
        <ul class="unstyled">
          <li class="text-info">Total Acres Burned: <strong><%= total_acres_burned %></strong> </li>
          <li class="text-info"></li>
          <li class="text-info">Latitude: <strong><%= @county.latitude %></strong></li>
          <li class="text-info">Longitude: <strong><%= @county.longitude %></strong></li>
        </ul>
    </div>

    <div class="span8" id="county-fires">
        <% if @county.fires.any? %>
          <h3><%= @county.fires.count %> fires | <%= total_acres_burned %> acres burned</h3>
          <table class="table table-bordered table-condensed">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Acres burned</th>
                  <th>Date started</th>
                  <th>Containment</th>
                </tr>
              </thead>

        <% @county.fires.each do |fire| %>
              <tbody>
                <tr>
                  <td><%= fire.name %></td>
                  <td><%= number_with_delimiter(fire.acreage) %></td>
                  <td><%= fire.date %></td>
                  <td><%= fire.containment %></td>
                </tr>
              </tbody>
        <% end %>
          </table>
        <% else %>
          <div class="alert">
              <button type="button" class="close" data-dismiss="alert">×</button>
              <strong>Warning!</strong> Best check yo self, you're not looking too good.
          </div>
        <% end %>
    </div>
</div>